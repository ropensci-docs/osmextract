<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is used to match an input place with the URL of a .osm.pbf
file (and its file-size, if present). The URLs are stored in several
provider's databases. See oe_providers() and examples."><title>Match input place with a url — oe_match • osmextract</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match input place with a url — oe_match"><meta property="og:description" content="This function is used to match an input place with the URL of a .osm.pbf
file (and its file-size, if present). The URLs are stored in several
provider's databases. See oe_providers() and examples."><meta property="og:image" content="https://docs.ropensci.org/osmextract/logo.svg"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">osmextract</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../articles/osmextract.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/providers.html">Add new OpenStreetMap providers</a>
    <a class="dropdown-item" href="../articles/providers_comparisons.html">Comparing the supported OSM providers</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/osmextract/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Match input place with a url</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/osmextract/blob/HEAD/R/match.R" class="external-link"><code>R/match.R</code></a></small>
      <div class="d-none name"><code>oe_match.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is used to match an input <code>place</code> with the URL of a <code>.osm.pbf</code>
file (and its file-size, if present). The URLs are stored in several
provider's databases. See <code><a href="oe_providers.html">oe_providers()</a></code> and examples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">place</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">oe_match</span><span class="op">(</span><span class="va">place</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for bbox</span></span>
<span><span class="fu">oe_match</span><span class="op">(</span><span class="va">place</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for sf</span></span>
<span><span class="fu">oe_match</span><span class="op">(</span><span class="va">place</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for sfc</span></span>
<span><span class="fu">oe_match</span><span class="op">(</span><span class="va">place</span>, provider <span class="op">=</span> <span class="st">"geofabrik"</span>, level <span class="op">=</span> <span class="cn">NULL</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for numeric</span></span>
<span><span class="fu">oe_match</span><span class="op">(</span><span class="va">place</span>, provider <span class="op">=</span> <span class="st">"geofabrik"</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for character</span></span>
<span><span class="fu">oe_match</span><span class="op">(</span></span>
<span>  <span class="va">place</span>,</span>
<span>  provider <span class="op">=</span> <span class="st">"geofabrik"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  match_by <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  max_string_dist <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>place</dt>
<dd><p>Description of the geographical area that should be matched with
a <code>.osm.pbf</code> file. Can be either a length-1 character vector, an
<code>sf</code>/<code>sfc</code>/<code>bbox</code> object, or a numeric vector of coordinates with length 2.
In the last case, it is assumed that the EPSG code is 4326 specified as
c(LON, LAT), while you can use any CRS with <code>sf</code>/<code>sfc</code>/<code>bbox</code> objects. See
Details and Examples in <code>oe_match()</code>.</p></dd>


<dt>...</dt>
<dd><p>arguments passed to other methods</p></dd>


<dt>provider</dt>
<dd><p>Which provider should be used to download the data? Available
providers can be found with the following command: <code><a href="oe_providers.html">oe_providers()</a></code>. For
<code><a href="oe_get.html">oe_get()</a></code> and <code>oe_match()</code>, if <code>place</code> is equal to <code>ITS Leeds</code>, then
<code>provider</code> is set equal to <code>test</code>. This is just for simple examples and
internal tests.</p></dd>


<dt>level</dt>
<dd><p>An integer representing the desired hierarchical level in case
of spatial matching. For the <code>geofabrik</code> provider, for example, <code>1</code>
corresponds with continent-level datasets, <code>2</code> for countries, <code>3</code>
corresponds to regions and <code>4</code> to subregions. Hence, we could approximately
say that smaller administrative units correspond to bigger levels. If
<code>NULL</code>, the default, the <code>oe_*</code> functions will select the highest available
level. See Details and Examples in <code>oe_match()</code>.</p></dd>


<dt>quiet</dt>
<dd><p>Boolean. If <code>FALSE</code>, the function prints informative messages.
Starting from <code>sf</code> version
<a href="https://r-spatial.github.io/sf/news/index.html#version-0-9-6-2020-09-13" class="external-link">0.9.6</a>,
if <code>quiet</code> is equal to <code>FALSE</code>, then vectortranslate operations will
display a progress bar.</p></dd>


<dt>match_by</dt>
<dd><p>Which column of the provider's database should be used for
matching the input <code>place</code> with a <code>.osm.pbf</code> file? The default is <code>"name"</code>.
Check Details and Examples in <code>oe_match()</code> to understand how this parameter
works. Ignored if <code>place</code> is not a character vector since the matching is
performed through a spatial operation.</p></dd>


<dt>max_string_dist</dt>
<dd><p>Numerical value greater or equal than 0. What is the
maximum distance in fuzzy matching (i.e. Approximate String Distance, see
<code><a href="https://rdrr.io/r/utils/adist.html" class="external-link">adist()</a></code>) between input <code>place</code> and <code>match_by</code> column to tolerate before
testing alternative providers or looking for geographical matching with
Nominatim API? This parameter is set equal to 0 if <code>match_by</code> is equal to
<code>iso3166_1_alpha2</code> or <code>iso3166_2</code>. Check Details and Examples in
<code>oe_match()</code> to understand why this parameter is important. Ignored if
<code>place</code> is not a character vector since the matching is performed through a
spatial operation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with two elements, named <code>url</code> and <code>file_size</code>. The first
element is the URL of the <code>.osm.pbf</code> file associated with the input
<code>place</code>, while the second element is the size of the file in bytes (which
may be <code>NULL</code> or <code>NA</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the input place is specified as a spatial object (either <code>sf</code> or <code>sfc</code>),
then the function will return a geographical area that completely contains
the object (or an error). The argument <code>level</code> (which must be specified as an
integer between 1 and 4, extreme values included) is used to select between
multiple geographically nested areas. We could roughly say that smaller
administrative units correspond to higher levels. Check the help page of the
chosen provider for more details on <code>level</code> field. By default, <code>level = NULL</code>, which means that <code>oe_match()</code> will return the area corresponding to
the highest available level. If there is no geographical area at the desired
level, then the function will return an error. If there are multiple areas at
the same <code>level</code> intersecting the input place, then the function will return
the area whose centroid is closest to the input place.</p>
<p>If the input place is specified as a character vector and there are multiple
plausible matches between the input place and the <code>match_by</code> column, then the
function will return a warning and it will select the first match. See
Examples. On the other hand, if the approximate string distance between the
input <code>place</code> and the best match in <code>match_by</code> column is greater than
<code>max_string_dist</code>, then the function will look for exact matches (i.e.
<code>max_string_dist = 0</code>) in the other supported providers. If it finds an exact
match, then it will return the corresponding URL. Otherwise, if <code>match_by</code> is
equal to <code>"name"</code>, then it will try to geolocate the input <code>place</code> using the
<a href="https://nominatim.org/release-docs/develop/api/Overview/" class="external-link">Nominatim API</a>,
and then it will perform a spatial matching operation (see Examples and
introductory vignette), while, if <code>match_by != "name"</code>, then it will return
an error.</p>
<p>The fields <code>iso3166_1_alpha2</code> and <code>iso3166_2</code> are used by Geofabrik provider
to perform matching operations using <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" class="external-link">ISO 3166-1 alpha-2</a> and <a href="https://en.wikipedia.org/wiki/ISO_3166-2" class="external-link">ISO 3166-2</a> codes. See
<a href="geofabrik_zones.html">geofabrik_zones</a> for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="oe_providers.html">oe_providers()</a></code> and <code><a href="oe_match_pattern.html">oe_match_pattern()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The simplest example:</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"Italy"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: Italy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/europe/italy-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.7e+09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The default provider is "geofabrik", but we can change that:</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"Leeds"</span>, provider <span class="op">=</span> <span class="st">"bbbike"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: Leeds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.bbbike.org/osm/bbbike/Leeds/Leeds.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24362749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By default, the matching operations are performed through the column</span></span></span>
<span class="r-in"><span><span class="co"># "name" in the provider's database but this can be a problem. Hence,</span></span></span>
<span class="r-in"><span><span class="co"># you can perform the matching operations using other columns:</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"RU"</span>, match_by <span class="op">=</span> <span class="st">"iso3166_1_alpha2"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: RU</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/russia-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.2e+09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Run oe_providers() for reading a short description of all providers and</span></span></span>
<span class="r-in"><span><span class="co"># check the help pages of the corresponding databases to learn which fields</span></span></span>
<span class="r-in"><span><span class="co"># are present.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can always increase the max_string_dist argument, but it can be</span></span></span>
<span class="r-in"><span><span class="co"># dangerous:</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"London"</span>, max_string_dist <span class="op">=</span> <span class="fl">3</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: Jordan</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/asia/jordan-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.9e+07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match the input zone using an sfc object:</span></span></span>
<span class="r-in"><span><span class="va">milan_duomo</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1514924</span>, <span class="fl">5034552</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">3003</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">milan_duomo</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with Nord-Ovest. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/europe/italy/nord-ovest-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.7e+08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">leeds</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">430147.8</span>, <span class="fl">433551.5</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">27700</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">leeds</span>, provider <span class="op">=</span> <span class="st">"bbbike"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with Leeds. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.bbbike.org/osm/bbbike/Leeds/Leeds.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24362749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you specify more than one sfg object, then oe_match will select the OSM</span></span></span>
<span class="r-in"><span><span class="co"># extract that covers all areas</span></span></span>
<span class="r-in"><span><span class="va">milan_leeds</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.190544</span>, <span class="fl">45.46416</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Milan</span></span></span>
<span class="r-in"><span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.543789</span>, <span class="fl">53.7974</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Leeds</span></span></span>
<span class="r-in"><span>  crs <span class="op">=</span> <span class="fl">4326</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">milan_leeds</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with Europe. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/europe-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.63e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match the input zone using a numeric vector of coordinates</span></span></span>
<span class="r-in"><span><span class="co"># (in which case crs = 4326 is assumed)</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.1916</span>, <span class="fl">45.4650</span><span class="op">)</span><span class="op">)</span> <span class="co"># Milan, Duomo using CRS = 4326</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with Nord-Ovest. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/europe/italy/nord-ovest-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.7e+08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following returns a warning since Berin is matched both</span></span></span>
<span class="r-in"><span><span class="co"># with Benin and Berlin</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"Berin"</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: Benin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.geofabrik.de/africa/benin-latest.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.7e+07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the input place does not match any zone in the chosen provider, then the</span></span></span>
<span class="r-in"><span><span class="co"># function will test the other providers:</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"Leeds"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No exact match found for place = Leeds and provider = geofabrik. Best match is Laos. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking the other providers.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> An exact string match was found using provider = bbbike.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $url</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "https://download.bbbike.org/osm/bbbike/Leeds/Leeds.osm.pbf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $file_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24362749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the input place cannot be exactly matched with any zone in any provider,</span></span></span>
<span class="r-in"><span><span class="co"># then the function will try to geolocate the input and then it will perform a</span></span></span>
<span class="r-in"><span><span class="co"># spatial match:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="st">"Milan"</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The level parameter can be used to select smaller or bigger geographical</span></span></span>
<span class="r-in"><span><span class="co"># areas during spatial matching</span></span></span>
<span class="r-in"><span><span class="va">yak</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">120.51084</span>, <span class="fl">46.60156</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">yak</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># error</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">yak</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># by default, level is equal to the maximum value</span></span></span>
<span class="r-in"><span><span class="fu">oe_match</span><span class="op">(</span><span class="va">yak</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

