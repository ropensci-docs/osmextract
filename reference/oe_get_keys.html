<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function returns the OSM keys and (optionally) the values stored in the
other_tags field. See Details. In both cases, the keys are sorted according
to the number of occurrences, which means that the most common keys are
stored first."><title>Return keys and (optionally) values stored in "other_tags" column — oe_get_keys • osmextract</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Return keys and (optionally) values stored in " other_tags column oe_get_keys><meta property="og:description" content="This function returns the OSM keys and (optionally) the values stored in the
other_tags field. See Details. In both cases, the keys are sorted according
to the number of occurrences, which means that the most common keys are
stored first."><meta property="og:image" content="https://docs.ropensci.org/osmextract/logo.svg"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">osmextract</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../articles/osmextract.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/providers.html">Add new OpenStreetMap providers</a>
    <a class="dropdown-item" href="../articles/providers_comparisons.html">Comparing the supported OSM providers</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/osmextract/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Return keys and (optionally) values stored in "other_tags" column</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/osmextract/blob/HEAD/R/get-key-values.R" class="external-link"><code>R/get-key-values.R</code></a></small>
      <div class="d-none name"><code>oe_get_keys.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function returns the OSM keys and (optionally) the values stored in the
<code>other_tags</code> field. See Details. In both cases, the keys are sorted according
to the number of occurrences, which means that the most common keys are
stored first.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">oe_get_keys</span><span class="op">(</span></span>
<span>  <span class="va">zone</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"lines"</span>,</span>
<span>  values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  which_keys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  download_directory <span class="op">=</span> <span class="fu"><a href="oe_download_directory.html">oe_download_directory</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">oe_get_keys</span><span class="op">(</span></span>
<span>  <span class="va">zone</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"lines"</span>,</span>
<span>  values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  which_keys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  download_directory <span class="op">=</span> <span class="fu"><a href="oe_download_directory.html">oe_download_directory</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for character</span></span>
<span><span class="fu">oe_get_keys</span><span class="op">(</span></span>
<span>  <span class="va">zone</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"lines"</span>,</span>
<span>  values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  which_keys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  download_directory <span class="op">=</span> <span class="fu"><a href="oe_download_directory.html">oe_download_directory</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for sf</span></span>
<span><span class="fu">oe_get_keys</span><span class="op">(</span></span>
<span>  <span class="va">zone</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"lines"</span>,</span>
<span>  values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  which_keys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  download_directory <span class="op">=</span> <span class="fu"><a href="oe_download_directory.html">oe_download_directory</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for oe_key_values_list</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oe_max_print_keys"</span>, <span class="fl">10L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>zone</dt>
<dd><p>An <code>sf</code> object with an <code>other_tags</code> field or a character vector
(of length 1) that can be linked to or pointing to a <code>.osm.pbf</code> or <code>.gpkg</code>
file with an <code>other_tags</code> field. Character vectors are linked to <code>.osm.pbf</code>
files using <code><a href="oe_find.html">oe_find()</a></code>.</p></dd>


<dt>layer</dt>
<dd><p>Which <code>layer</code> should be read in? Typically <code>points</code>, <code>lines</code>
(the default), <code>multilinestrings</code>, <code>multipolygons</code> or <code>other_relations</code>. If
you specify an ad-hoc query using the argument <code>query</code> (see introductory
vignette and examples), then <code><a href="oe_get.html">oe_get()</a></code> and <code><a href="oe_read.html">oe_read()</a></code> will read the layer
specified in the query and ignore <code>layer</code>. See also
<a href="https://github.com/ropensci/osmextract/issues/122" class="external-link">#122</a>.</p></dd>


<dt>values</dt>
<dd><p>Logical. If <code>TRUE</code>, then function returns the keys and the
corresponding values, otherwise only the keys. Defaults to <code>FALSE. </code></p></dd>


<dt>which_keys</dt>
<dd><p>Character vector used to subset only some keys and
corresponding values. Ignored if <code>values</code> is <code>FALSE</code>. See examples.</p></dd>


<dt>download_directory</dt>
<dd><p>Path of the directory that stores the <code>.osm.pbf</code>
files. Only relevant when <code>zone</code> is as a character vector that must be
matched to a file via <code><a href="oe_find.html">oe_find()</a></code>. Ignored unless <code>zone</code> is a character
vector.</p></dd>


<dt>x</dt>
<dd><p>object of class <code>oe_key_values_list</code></p></dd>


<dt>n</dt>
<dd><p>Maximum number of keys (and corresponding values) to print; can be
set globally by <code>options(oe_max_print_keys=...)</code>. Default value is 10.</p></dd>


<dt>...</dt>
<dd><p>Ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If the argument <code>values</code> is <code>FALSE</code> (the default), then the function
returns a character vector with the names of all keys stored in the
<code>other_tags</code> field. If <code>values</code> is <code>TRUE</code>, then the function returns named
list which stores all keys and the corresponding values. In the latter
case, the returned object has class <code>oe_key_values_list</code> and we defined an
ad-hoc printing method. See Details.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>OSM data are typically documented using several
<a href="https://wiki.openstreetmap.org/wiki/Tags" class="external-link"><code>tags</code></a>, i.e. pairs of two
items, namely a <code>key</code> and a <code>value</code>. The conversion between <code>.osm.pbf</code> and
<code>.gpkg</code> formats is governed by a <code>CONFIG</code> file that lists which tags must
be explicitly added to the <code>.gpkg</code> file. All the other keys are
automatically stored using an <code>other_tags</code> field with a syntax compatible
with the PostgreSQL HSTORE type. See
<a href="https://gdal.org/drivers/vector/osm.html#driver-capabilities" class="external-link">here</a> for
more details.</p>
<p>When the argument <code>values</code> is <code>TRUE</code>, then the function returns a named
list of class <code>oe_key_values_list</code> that, for each key, summarises the
corresponding values. The key-value pairs are stored using the following
format: <code>list(key1 = c("value1", "value1", "value2", ...), key2 = c("value1", ...) ...)</code>. We decided to implement an ad-hoc method for
printing objects of class <code>oe_key_values_list</code> using the following
structure:</p><div class="sourceCode"><pre><code>key1 = {#value1 = n1; #value2 = n2; #value3 = n3,
  ...} key2 = {#value1 = n1; #value2 = n2; ...} key3 = {#value1 = n1} ...</code></pre></div><p>where <code>n1</code> denotes the number of times that value1 is repeated, <code>n2</code>
denotes the number of times that value2 is repeated and so on. Also the
values are listed according to the number of occurrences in decreasing
order. By default, the function prints only the ten most common keys, but
the number can be adjusted using the option <code>oe_max_print_keys</code>.</p>
<p>Finally, the <code>hstore_get_value()</code> function can be used inside the <code>query</code>
argument in <code><a href="oe_get.html">oe_get()</a></code> to extract one particular tag from an existing file.
Check the introductory vignette and see examples.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="oe_vectortranslate.html">oe_vectortranslate()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Copy the ITS file to tempdir() to make sure that the examples do not</span></span></span>
<span class="r-in"><span><span class="co"># require internet connection. You can skip the next 4 lines (and start</span></span></span>
<span class="r-in"><span><span class="co"># directly with oe_get_keys) when running the examples locally.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">its_pbf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"test_its-example.osm.pbf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"its-example.osm.pbf"</span>, package <span class="op">=</span> <span class="st">"osmextract"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  to <span class="op">=</span> <span class="va">its_pbf</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get keys</span></span></span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span><span class="st">"ITS Leeds"</span>, download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "surface"             "lanes"               "bicycle"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "lit"                 "access"              "oneway"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "maxspeed"            "ref"                 "foot"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "natural"             "lanes:backward"      "lanes:forward"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "source:name"         "step_count"          "lanes:psv:backward" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "alt_name"            "layer"               "motor_vehicle"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "tunnel"              "bridge"              "covered"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "incline"             "lanes:psv"           "service"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "turn:lanes"          "turn:lanes:forward"  "frequency"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "indoor"              "lcn"                 "level"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "maxheight"           "operator"            "power"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34] "source:geometry"     "substation"          "turn:lanes:backward"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "voltage"             "website"            </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get keys and values</span></span></span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span><span class="st">"ITS Leeds"</span>, values <span class="op">=</span> <span class="cn">TRUE</span>, download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found 38 unique keys, printed in ascending order of % NA values. The first 10 keys are: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> surface (91% NAs) = {#asphalt = 12; #paved = 3; #cobblestone = 1; #paving_sto...}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lanes (91% NAs) = {#2 = 9; #1 = 7}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bicycle (92% NAs) = {#yes = 10; #designated = 5}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lit (92% NAs) = {#yes = 15}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> access (92% NAs) = {#permissive = 12; #yes = 2}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oneway (93% NAs) = {#yes = 13}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> maxspeed (93% NAs) = {#30 mph = 12}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref (94% NAs) = {#A660 = 9; #4184 = 1}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> foot (95% NAs) = {#yes = 5; #designated = 4}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> natural (96% NAs) = {#tree_row = 7}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [Truncated output...]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subset some keys</span></span></span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"ITS Leeds"</span>, values <span class="op">=</span> <span class="cn">TRUE</span>, which_keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"surface"</span>, <span class="st">"lanes"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found 2 unique keys, printed in ascending order of % NA values. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> surface (91% NAs) = {#asphalt = 12; #paved = 3; #cobblestone = 1; #paving_sto...}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lanes (91% NAs) = {#2 = 9; #1 = 7}</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print all (non-NA) values for a given set of keys</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">oe_get_keys</span><span class="op">(</span><span class="st">"ITS Leeds"</span>, values <span class="op">=</span> <span class="cn">TRUE</span>, download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">[</span><span class="st">"surface"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $surface</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "asphalt"       "asphalt"       "asphalt"       "asphalt"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "asphalt"       "asphalt"       "paved"         "cobblestone"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "asphalt"       "asphalt"       "paved"         "paved"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "paving_stones" "asphalt"       "asphalt"       "asphalt"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "asphalt"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get keys from an existing sf object</span></span></span>
<span class="r-in"><span><span class="va">its</span> <span class="op">=</span> <span class="fu"><a href="oe_get.html">oe_get</a></span><span class="op">(</span><span class="st">"ITS Leeds"</span>, download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: ITS Leeds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The chosen file was already detected in the download directory. Skip downloading.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting with the vectortranslate operations on the input file!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0...10...20...30...40...50...60...70...80...90...100 - done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished the vectortranslate operations on the input file!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `lines' from data source `/tmp/RtmpM8EDhc/test_its-example.gpkg' using driver `GPKG'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 189 features and 9 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -1.562458 ymin: 53.80471 xmax: -1.548076 ymax: 53.81105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span><span class="va">its</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found 38 unique keys, printed in ascending order of % NA values. The first 10 keys are: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> surface (91% NAs) = {#asphalt = 12; #paved = 3; #cobblestone = 1; #paving_sto...}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lanes (91% NAs) = {#2 = 9; #1 = 7}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bicycle (92% NAs) = {#yes = 10; #designated = 5}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lit (92% NAs) = {#yes = 15}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> access (92% NAs) = {#permissive = 12; #yes = 2}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oneway (93% NAs) = {#yes = 13}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> maxspeed (93% NAs) = {#30 mph = 12}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref (94% NAs) = {#A660 = 9; #4184 = 1}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> foot (95% NAs) = {#yes = 5; #designated = 4}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> natural (96% NAs) = {#tree_row = 7}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [Truncated output...]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get keys from a character vector pointing to a file (might be faster than</span></span></span>
<span class="r-in"><span><span class="co"># reading the complete file and then filter it)</span></span></span>
<span class="r-in"><span><span class="va">its_path</span> <span class="op">=</span> <span class="fu"><a href="oe_get.html">oe_get</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"ITS Leeds"</span>, download_only <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span><span class="va">its_path</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found 38 unique keys, printed in ascending order of % NA values. The first 10 keys are: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> surface (91% NAs) = {#asphalt = 12; #paved = 3; #cobblestone = 1; #paving_sto...}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lanes (91% NAs) = {#2 = 9; #1 = 7}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bicycle (92% NAs) = {#yes = 10; #designated = 5}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lit (92% NAs) = {#yes = 15}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> access (92% NAs) = {#permissive = 12; #yes = 2}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oneway (93% NAs) = {#yes = 13}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> maxspeed (93% NAs) = {#30 mph = 12}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref (94% NAs) = {#A660 = 9; #4184 = 1}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> foot (95% NAs) = {#yes = 5; #designated = 4}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> natural (96% NAs) = {#tree_row = 7}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [Truncated output...]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a key to an existing .gpkg file without repeating the</span></span></span>
<span class="r-in"><span><span class="co"># vectortranslate operations</span></span></span>
<span class="r-in"><span><span class="va">its</span> <span class="op">=</span> <span class="fu"><a href="oe_get.html">oe_get</a></span><span class="op">(</span><span class="st">"ITS Leeds"</span>, download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input place was matched with: ITS Leeds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The chosen file was already detected in the download directory. Skip downloading.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The corresponding gpkg file was already detected. Skip vectortranslate operations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `lines' from data source `/tmp/RtmpM8EDhc/test_its-example.gpkg' using driver `GPKG'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 189 features and 9 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -1.562458 ymin: 53.80471 xmax: -1.548076 ymax: 53.81105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">its</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "osm_id"     "name"       "highway"    "waterway"   "aerialway" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "barrier"    "man_made"   "z_order"    "other_tags" "geometry"  </span>
<span class="r-in"><span><span class="va">its_extra</span> <span class="op">=</span> <span class="fu"><a href="oe_read.html">oe_read</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">its_path</span>,</span></span>
<span class="r-in"><span>  query <span class="op">=</span> <span class="st">"SELECT *, hstore_get_value(other_tags, 'oneway') AS oneway FROM lines"</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">its_extra</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "osm_id"     "name"       "highway"    "waterway"   "aerialway" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "barrier"    "man_made"   "z_order"    "other_tags" "oneway"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "geometry"  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following fails since there is no points layer in the .gpkg file</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span><span class="va">its_path</span>, layer <span class="op">=</span> <span class="st">"points"</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add layer and read keys</span></span></span>
<span class="r-in"><span><span class="va">its_path</span> <span class="op">=</span> <span class="fu"><a href="oe_get.html">oe_get</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"ITS Leeds"</span>, layer <span class="op">=</span> <span class="st">"points"</span>, download_only <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  download_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">oe_get_keys</span><span class="op">(</span><span class="va">its_path</span>, layer <span class="op">=</span> <span class="st">"points"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "amenity"                 "addr:postcode"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "addr:street"             "addr:city"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "fhrs:id"                 "capacity"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "covered"                 "addr:housenumber"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "operator"                "bicycle_parking"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "addr:suburb"             "natural"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "shop"                    "crossing"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "naptan:AtcoCode"         "naptan:Bearing"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "naptan:CommonName"       "naptan:PlusbusZoneRef"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "naptan:ShortCommonName"  "naptan:Street"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "naptan:verified"         "addr:housename"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "bus"                     "collection_times"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "local_ref"               "naptan:Crossing"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27] "naptan:Indicator"        "naptan:Landmark"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "public_transport"        "condition"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "entrance"                "ref:UK:leedscc:bin"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "shelter"                 "waste_basket:model"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35] "crossing_ref"            "wheelchair"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "brand"                   "brand:wikidata"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] "brand:wikipedia"         "noexit"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "booth"                   "old_name"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] "opening_hours"           "advertising"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45] "foot"                    "kerb"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [47] "post_box:type"           "tactile_paving"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] "takeaway"                "toilets:wheelchair"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51] "addr:unit"               "cuisine"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53] "level"                   "naptan:Notes"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55] "royal_cypher"            "source:addr"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57] "timetable"               "tourism"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [59] "website"                 "access"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] "addr:source"             "artist_name"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [63] "artwork_type"            "atm"                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [65] "bicycle"                 "building"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67] "contact:website"         "direction"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [69] "fee"                     "healthcare"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [71] "historic"                "horse"                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [73] "live_display"            "loc_name"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [75] "material"                "motor_vehicle"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [77] "naptan:BusStopType"      "not:addr:postcode"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [79] "phone"                   "post_box:design"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [81] "recycling:glass_bottles" "recycling:paper"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [83] "traffic_signals"         "url"                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [85] "wikidata"               </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove .pbf and .gpkg files in tempdir</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">its_pbf</span>, <span class="va">res</span>, <span class="va">its_path</span>, <span class="va">its</span>, <span class="va">its_extra</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="oe_clean.html">oe_clean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

